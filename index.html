<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=5">
    <meta name="description" content="Quiniela Oficial Liga MX - Participa y gana premios prediciendo los resultados">
    <meta name="theme-color" content="#1a1a2e">
    <title> Quiniela Liga MX - Jornada 1</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --success: #10b981;
            --success-dark: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-primary: #0f0f23;
            --bg-secondary: #1a1a2e;
            --bg-card: #16213e;
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --border-color: #334155;
            --local-color: #22c55e;
            --empate-color: #eab308;
            --visita-color: #3b82f6;
            --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Header con gradiente animado */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #6366f1 100%);
            background-size: 200% 200%;
            animation: gradientShift 8s ease infinite;
            padding: 30px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .logo {
            font-size: 3rem;
            margin-bottom: 10px;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
        }

        .header h1 {
            font-size: 1.8rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .jornada {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 5px;
            font-weight: 500;
        }

        /* Contador de tiempo */
        .countdown-container {
            background: var(--bg-secondary);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .countdown {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .countdown-item {
            background: var(--bg-card);
            padding: 15px 20px;
            border-radius: 12px;
            text-align: center;
            min-width: 80px;
            border: 1px solid var(--border-color);
        }

        .countdown-number {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
            display: block;
        }

        .countdown-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .countdown-title {
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        /* Barra de progreso */
        .progress-container {
            background: var(--bg-secondary);
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }

        .progress-bar {
            height: 8px;
            background: var(--bg-card);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--primary));
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        .progress-text span:last-child {
            color: var(--success);
            font-weight: 600;
        }

        /* Container principal */
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Leyenda de colores */
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 15px;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-dot.local { background: var(--local-color); }
        .legend-dot.empate { background: var(--empate-color); }
        .legend-dot.visita { background: var(--visita-color); }

        /* Tarjeta de partido mejorada */
        .match-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .match-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--border-color);
            transition: background 0.3s ease;
        }

        .match-card.selected-L::before { background: var(--local-color); }
        .match-card.selected-E::before { background: var(--empate-color); }
        .match-card.selected-V::before { background: var(--visita-color); }

        .match-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border-color: var(--primary);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .match-number {
            background: var(--primary);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        .match-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .teams {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            align-items: center;
            gap: 10px;
            margin-bottom: 18px;
        }

        .team {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .team.home {
            justify-content: flex-start;
        }

        .team.away {
            justify-content: flex-end;
            flex-direction: row-reverse;
        }

        .team-logo {
            width: 40px;
            height: 40px;
            background: var(--bg-secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .team-name {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text-primary);
        }

        .vs-badge {
            background: var(--bg-secondary);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Botones de opciones mejorados */
        .options {
            display: flex;
            gap: 10px;
        }

        .options input[type="radio"] {
            display: none;
        }

        .options label {
            flex: 1;
            text-align: center;
            padding: 14px 10px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-secondary);
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        .options label:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .options label .label-text {
            display: block;
            font-size: 0.75rem;
            margin-top: 2px;
            opacity: 0.7;
        }

        input[value="L"]:checked + label {
            background: rgba(34, 197, 94, 0.15);
            border-color: var(--local-color);
            color: var(--local-color);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.2);
        }

        input[value="E"]:checked + label {
            background: rgba(234, 179, 8, 0.15);
            border-color: var(--empate-color);
            color: var(--empate-color);
            box-shadow: 0 0 20px rgba(234, 179, 8, 0.2);
        }

        input[value="V"]:checked + label {
            background: rgba(59, 130, 246, 0.15);
            border-color: var(--visita-color);
            color: var(--visita-color);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.2);
        }

        /* Secci贸n de datos del usuario */
        .user-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 25px;
            margin-top: 30px;
        }

        .user-section h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 1.1rem;
            color: var(--text-primary);
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 15px 18px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        /* Checkbox de t茅rminos */
        .terms-group {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-top: 20px;
            padding: 15px;
            background: var(--bg-secondary);
            border-radius: 12px;
        }

        .terms-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--primary);
            margin-top: 2px;
            cursor: pointer;
        }

        .terms-group label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .terms-group a {
            color: var(--primary);
            text-decoration: none;
        }

        .terms-group a:hover {
            text-decoration: underline;
        }

        /* Bot贸n de env铆o */
        .submit-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--success), var(--success-dark));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .submit-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }

        .submit-btn:disabled {
            background: var(--border-color);
            cursor: not-allowed;
            transform: none;
        }

        .submit-btn .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            padding: 16px 24px;
            border-radius: 12px;
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            max-width: 350px;
        }

        .toast.success { background: linear-gradient(135deg, #10b981, #059669); }
        .toast.error { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .toast.warning { background: linear-gradient(135deg, #f59e0b, #d97706); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px 20px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .footer a {
            color: var(--primary);
            text-decoration: none;
        }

        /* Estad铆sticas r谩pidas */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Premio destacado */
        .prize-banner {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .prize-banner::before {
            content: '';
            position: absolute;
            font-size: 4rem;
            opacity: 0.2;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        .prize-banner h3 {
            color: #1a1a2e;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 5px;
        }

        .prize-amount {
            color: #1a1a2e;
            font-size: 2rem;
            font-weight: 800;
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        
        /* Tablets y pantallas medianas (768px - 1024px) */
        @media (max-width: 1024px) {
            .container {
                padding: 20px;
                max-width: 100%;
            }
            
            .stats-bar {
                gap: 15px;
            }
            
            .admin-panel {
                width: 95%;
                max-width: 600px;
            }
            
            .admin-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Tablets peque帽as (600px - 768px) */
        @media (max-width: 768px) {
            .header {
                padding: 25px 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
                letter-spacing: 1px;
            }
            
            .logo {
                font-size: 2.5rem;
            }
            
            .countdown {
                gap: 10px;
            }
            
            .countdown-item {
                min-width: 70px;
                padding: 12px;
            }
            
            .countdown-number {
                font-size: 1.5rem;
            }
            
            .countdown-label {
                font-size: 0.7rem;
            }
            
            .stats-bar {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .stat-item {
                flex: 1 1 30%;
                min-width: 80px;
            }
            
            .match-card {
                padding: 20px 15px;
            }
            
            .teams {
                gap: 10px;
            }
            
            .team-logo {
                width: 45px;
                height: 45px;
                font-size: 1.4rem;
            }
            
            .team-name {
                font-size: 0.9rem;
            }
            
            .vs-badge {
                font-size: 0.8rem;
                padding: 6px 12px;
            }
            
            .options {
                gap: 8px;
            }
            
            .options label {
                padding: 12px 15px;
                font-size: 1rem;
            }
            
            .prize-banner {
                padding: 20px;
            }
            
            .prize-amount {
                font-size: 1.8rem;
            }
            
            .legend {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .faq-section {
                padding: 15px;
            }
            
            .faq-question {
                font-size: 0.95rem;
            }
            
            .admin-tabs {
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .admin-tab {
                flex: 1 1 45%;
                padding: 10px;
                font-size: 0.85rem;
            }
            
            .modal {
                width: 95%;
                padding: 20px;
                max-height: 90vh;
                overflow-y: auto;
            }
            
            .predictions-summary {
                max-height: 200px;
            }
        }
        
        /* M贸viles grandes (480px - 600px) */
        @media (max-width: 600px) {
            body {
                font-size: 14px;
            }
            
            .header {
                padding: 20px 10px;
            }
            
            .header h1 {
                font-size: 1.3rem;
            }
            
            .header .jornada {
                font-size: 0.85rem;
            }
            
            .logo {
                font-size: 2rem;
            }
            
            .countdown-container {
                padding: 15px 10px;
            }
            
            .countdown-title {
                font-size: 0.85rem;
            }
            
            .countdown {
                gap: 8px;
            }
            
            .countdown-item {
                min-width: 60px;
                padding: 10px 8px;
            }
            
            .countdown-number {
                font-size: 1.3rem;
            }
            
            .progress-container {
                padding: 15px;
            }
            
            .progress-dots {
                gap: 6px;
            }
            
            .progress-dot {
                width: 10px;
                height: 10px;
            }
            
            .container {
                padding: 10px;
            }
            
            .match-card {
                padding: 15px 12px;
                border-radius: 12px;
            }
            
            .match-header {
                flex-direction: column;
                gap: 5px;
                align-items: flex-start;
            }
            
            .match-number {
                width: 28px;
                height: 28px;
                font-size: 0.85rem;
            }
            
            .match-date {
                font-size: 0.75rem;
            }
            
            .teams {
                flex-direction: row;
                gap: 8px;
                margin: 15px 0;
            }
            
            .team {
                flex: 1;
            }
            
            .team-logo {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .team-name {
                font-size: 0.8rem;
                max-width: 80px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            
            .vs-badge {
                font-size: 0.7rem;
                padding: 4px 8px;
                min-width: auto;
            }
            
            .options {
                gap: 6px;
            }
            
            .options label {
                padding: 10px 8px;
                font-size: 0.9rem;
                border-radius: 8px;
            }
            
            .label-text {
                display: none;
            }
            
            .user-section {
                padding: 20px 15px;
            }
            
            .user-section h3 {
                font-size: 1.1rem;
            }
            
            .input-group input {
                padding: 12px;
                font-size: 0.95rem;
            }
            
            .submit-btn {
                padding: 16px;
                font-size: 1rem;
            }
            
            .stats-bar {
                padding: 15px 10px;
                gap: 8px;
            }
            
            .stat-item {
                flex: 1 1 28%;
            }
            
            .stat-number {
                font-size: 1.2rem;
            }
            
            .stat-label {
                font-size: 0.65rem;
            }
            
            .prize-banner {
                padding: 15px;
                border-radius: 12px;
            }
            
            .prize-banner h3 {
                font-size: 0.8rem;
            }
            
            .prize-amount {
                font-size: 1.5rem;
            }
            
            .legend {
                padding: 10px;
                gap: 8px;
            }
            
            .legend-item {
                font-size: 0.75rem;
            }
            
            .toast {
                max-width: 90%;
                left: 5%;
                right: 5%;
                padding: 12px 15px;
                font-size: 0.85rem;
            }
            
            .admin-btn {
                width: 50px;
                height: 50px;
                bottom: 15px;
                right: 15px;
                font-size: 1.2rem;
            }
            
            .faq-section {
                margin-top: 20px;
                padding: 15px;
            }
            
            .faq-question {
                font-size: 0.9rem;
            }
            
            .faq-answer {
                font-size: 0.85rem;
            }
            
            .support-section {
                padding: 15px;
            }
            
            .support-section h4 {
                font-size: 1rem;
            }
            
            .footer {
                padding: 20px 15px;
                font-size: 0.8rem;
            }
        }
        
        /* M贸viles peque帽os (menos de 480px) */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.1rem;
                letter-spacing: 0.5px;
            }
            
            .header .jornada {
                font-size: 0.75rem;
            }
            
            .logo {
                font-size: 1.8rem;
                margin-bottom: 5px;
            }
            
            .countdown-item {
                min-width: 55px;
                padding: 8px 6px;
            }
            
            .countdown-number {
                font-size: 1.1rem;
            }
            
            .countdown-label {
                font-size: 0.6rem;
            }
            
            .team-logo {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .team-name {
                font-size: 0.75rem;
                max-width: 70px;
            }
            
            .options label {
                padding: 10px 6px;
                font-size: 0.85rem;
            }
            
            .stat-number {
                font-size: 1rem;
            }
            
            .modal {
                padding: 15px;
                border-radius: 15px;
            }
            
            .modal-icon {
                font-size: 3rem;
            }
            
            .modal h3 {
                font-size: 1.1rem;
            }
            
            .modal p {
                font-size: 0.85rem;
            }
            
            .modal-buttons {
                flex-direction: column;
            }
            
            .modal-btn {
                width: 100%;
            }
            
            .prediction-item {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
            
            .admin-panel {
                padding: 15px;
                border-radius: 15px;
            }
            
            .admin-header h2 {
                font-size: 1.1rem;
            }
            
            .admin-tab {
                flex: 1 1 100%;
                text-align: center;
            }
            
            .admin-section h4 {
                font-size: 0.95rem;
            }
            
            .admin-input-group label {
                font-size: 0.8rem;
            }
            
            .admin-input-group input,
            .admin-input-group select {
                padding: 10px;
                font-size: 0.9rem;
            }
            
            .terms-group {
                font-size: 0.8rem;
            }
            
            .terms-group label {
                line-height: 1.4;
            }
        }
        
        /* M贸viles muy peque帽os (menos de 360px) */
        @media (max-width: 360px) {
            .header h1 {
                font-size: 1rem;
            }
            
            .countdown-item {
                min-width: 48px;
                padding: 6px 4px;
            }
            
            .countdown-number {
                font-size: 1rem;
            }
            
            .team-logo {
                width: 30px;
                height: 30px;
                font-size: 0.9rem;
            }
            
            .team-name {
                font-size: 0.7rem;
                max-width: 60px;
            }
            
            .options label {
                padding: 8px 4px;
                font-size: 0.8rem;
            }
            
            .prize-amount {
                font-size: 1.3rem;
            }
            
            .stat-item {
                flex: 1 1 100%;
            }
        }
        
        /* Ajustes para pantallas landscape en m贸viles */
        @media (max-height: 500px) and (orientation: landscape) {
            .header {
                padding: 15px;
            }
            
            .logo {
                font-size: 1.5rem;
            }
            
            .countdown-container {
                padding: 10px;
            }
            
            .modal {
                max-height: 95vh;
            }
            
            .predictions-summary {
                max-height: 120px;
            }
        }
        
        /* Mejoras para tablets en landscape */
        @media (min-width: 768px) and (max-width: 1024px) and (orientation: landscape) {
            .container {
                max-width: 800px;
            }
            
            .match-card {
                padding: 20px;
            }
            
            .admin-panel {
                max-width: 700px;
            }
        }
        
        /* Soporte para pantallas de alta densidad */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .team-logo,
            .logo {
                image-rendering: -webkit-optimize-contrast;
            }
        }
        
        /* Preferencia de movimiento reducido */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Modo oscuro del sistema (ya es oscuro, pero ajustes finos) */
        @media (prefers-color-scheme: dark) {
            :root {
                color-scheme: dark;
            }
        }
        
        /* Print styles */
        @media print {
            .header,
            .countdown-container,
            .admin-btn,
            .submit-btn,
            .toast-container,
            .faq-section,
            .support-section,
            .footer {
                display: none !important;
            }
            
            .match-card {
                break-inside: avoid;
                page-break-inside: avoid;
            }
            
            body {
                background: white;
                color: black;
            }
        }

        /* Animaci贸n de shake para errores */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s ease;
        }

        /* Modal de confirmaci贸n */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: scale(1);
        }

        .modal-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .modal h3 {
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .modal p {
            color: var(--text-secondary);
            margin-bottom: 25px;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn.cancel {
            background: var(--bg-secondary);
            color: var(--text-secondary);
        }

        .modal-btn.confirm {
            background: var(--success);
            color: white;
        }

        .modal-btn:hover {
            transform: translateY(-2px);
        }

        /* Admin Button */
        .admin-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
            transition: all 0.3s ease;
            z-index: 9998;
            font-size: 1.5rem;
            border: none;
        }

        .admin-btn:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 15px 40px rgba(99, 102, 241, 0.6);
        }

        /* Admin Panel Modal */
        .admin-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .admin-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .admin-panel {
            background: var(--bg-card);
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .admin-modal.active .admin-panel {
            transform: scale(1);
        }

        .admin-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 25px 30px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-header h2 {
            margin: 0;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-close {
            background: rgba(255,255,255,0.2);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .admin-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }

        .admin-tabs {
            display: flex;
            gap: 5px;
            padding: 20px 30px 0;
            border-bottom: 2px solid var(--border-color);
        }

        .admin-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            border-radius: 8px 8px 0 0;
            position: relative;
        }

        .admin-tab:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .admin-tab.active {
            color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }

        .admin-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        .admin-content {
            padding: 30px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .admin-section {
            margin-bottom: 30px;
        }

        .admin-section h4 {
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .admin-input-group {
            margin-bottom: 15px;
        }

        .admin-input-group label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .admin-input-group input,
        .admin-input-group select,
        .admin-input-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .admin-input-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .admin-input-group input:focus,
        .admin-input-group select:focus,
        .admin-input-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .match-config {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .match-config-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .match-config-header h5 {
            margin: 0;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .btn-small {
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: var(--success-dark);
            transform: translateY(-2px);
        }

        .admin-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        .admin-login {
            text-align: center;
            padding: 40px 30px;
        }

        .admin-login h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .admin-login input {
            width: 100%;
            max-width: 300px;
            padding: 15px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .admin-login input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .admin-login button {
            width: 100%;
            max-width: 300px;
            padding: 15px;
            background: var(--primary);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .admin-login button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .result-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .result-input input {
            width: 60px;
            text-align: center;
        }

        .result-separator {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        /* Password Strength Indicator */
        .password-strength {
            height: 4px;
            border-radius: 2px;
            margin-top: 8px;
            transition: all 0.3s ease;
            background: var(--border-color);
        }

        .password-strength.weak {
            background: linear-gradient(to right, #ef4444 0%, #ef4444 33%, var(--border-color) 33%);
        }

        .password-strength.medium {
            background: linear-gradient(to right, #f59e0b 0%, #f59e0b 66%, var(--border-color) 66%);
        }

        .password-strength.strong {
            background: linear-gradient(to right, #10b981 0%, #10b981 100%);
        }

        .password-requirements {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .password-requirements.valid {
            color: var(--success);
        }

        .password-requirements.invalid {
            color: var(--danger);
        }

        /* ==================== MEJORAS UX ==================== */
        
        /* Indicador de campos faltantes */
        .match-card.missing {
            border: 2px solid var(--danger);
            animation: pulse-border 1.5s infinite;
        }
        
        @keyframes pulse-border {
            0%, 100% { border-color: var(--danger); }
            50% { border-color: transparent; }
        }
        
        .match-card.completed {
            border: 2px solid var(--success);
        }
        
        .match-card .completion-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s ease;
        }
        
        .match-card.completed .completion-badge {
            opacity: 1;
            transform: scale(1);
            background: var(--success);
            color: white;
        }
        
        /* Progreso visual mejorado */
        .progress-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .progress-dot.completed {
            background: var(--success);
            transform: scale(1.1);
        }
        
        .progress-dot:hover {
            transform: scale(1.3);
        }
        
        .progress-dot::after {
            content: attr(data-match);
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: var(--text-secondary);
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .progress-dot:hover::after {
            opacity: 1;
        }
        
        /* Contador de caracteres */
        .char-counter {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: right;
            margin-top: 4px;
        }
        
        .char-counter.warning {
            color: var(--warning);
        }
        
        .char-counter.error {
            color: var(--danger);
        }
        
        /* Validaci贸n de email */
        .input-group input.valid {
            border-color: var(--success);
        }
        
        .input-group input.invalid {
            border-color: var(--danger);
        }
        
        .validation-message {
            font-size: 0.75rem;
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .validation-message.success {
            color: var(--success);
        }
        
        .validation-message.error {
            color: var(--danger);
        }
        
        /* Resumen de predicciones en modal */
        .predictions-summary {
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
            text-align: left;
        }
        
        .prediction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-bottom: 6px;
            font-size: 0.85rem;
        }
        
        .prediction-item .teams {
            flex: 1;
        }
        
        .prediction-item .result {
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.75rem;
        }
        
        .prediction-item .result.L {
            background: var(--local-color);
            color: white;
        }
        
        .prediction-item .result.E {
            background: var(--empate-color);
            color: #1a1a2e;
        }
        
        .prediction-item .result.V {
            background: var(--visita-color);
            color: white;
        }
        
        /* FAQ Section */
        .faq-section {
            margin-top: 30px;
            padding: 20px;
            background: var(--bg-card);
            border-radius: 16px;
        }
        
        .faq-section h3 {
            text-align: center;
            margin-bottom: 20px;
            color: var(--text-primary);
        }
        
        .faq-item {
            border-bottom: 1px solid var(--border-color);
            padding: 15px 0;
        }
        
        .faq-item:last-child {
            border-bottom: none;
        }
        
        .faq-question {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .faq-question::after {
            content: '+';
            font-size: 1.5rem;
            transition: transform 0.3s;
        }
        
        .faq-item.open .faq-question::after {
            transform: rotate(45deg);
        }
        
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        .faq-item.open .faq-answer {
            max-height: 200px;
            padding-top: 10px;
        }
        
        /* Success Modal mejorado */
        .success-modal {
            background: linear-gradient(135deg, var(--success) 0%, var(--success-dark) 100%);
        }
        
        .success-modal .confetti {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        /* Historial de participaciones */
        .history-section {
            margin-top: 20px;
        }
        
        .history-item {
            background: var(--bg-secondary);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-item .date {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .history-item .status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .history-item .status.pending {
            background: var(--warning);
            color: #1a1a2e;
        }
        
        .history-item .status.completed {
            background: var(--success);
            color: white;
        }
        
        /* Admin Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--bg-secondary);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-card .number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .stat-card .label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }
        
        /* Prediction Stats */
        .prediction-stats {
            margin-top: 20px;
        }
        
        .prediction-bar {
            display: flex;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .prediction-bar .local {
            background: var(--local-color);
        }
        
        .prediction-bar .empate {
            background: var(--empate-color);
        }
        
        .prediction-bar .visita {
            background: var(--visita-color);
        }
        
        /* Contacto/Soporte */
        .support-section {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 16px;
            margin-top: 20px;
            text-align: center;
        }
        
        .support-section a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .support-section a:hover {
            text-decoration: underline;
        }
        
        /* Skip to content - Accesibilidad */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            z-index: 100000;
            transition: top 0.3s;
        }
        
        .skip-link:focus {
            top: 0;
        }
        
        /* Focus visible para accesibilidad */
        *:focus-visible {
            outline: 3px solid var(--primary);
            outline-offset: 2px;
        }
        
        /* Rate limit warning */
        .rate-limit-warning {
            background: var(--warning);
            color: #1a1a2e;
            padding: 10px 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            display: none;
        }
        
        .rate-limit-warning.active {
            display: block;
        }

    </style>
</head>
<body>

<!-- Skip Link para Accesibilidad -->
<a href="#quinielaForm" class="skip-link">Saltar al contenido principal</a>

<!-- Rate Limit Warning -->
<div class="rate-limit-warning" id="rateLimitWarning">
     Por favor espera antes de enviar otra quiniela
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Admin Button -->
<button class="admin-btn" onclick="openAdminPanel()" title="Panel de Administrador">锔</button>

<!-- Admin Panel Modal -->
<div class="admin-modal" id="adminModal">
    <div class="admin-panel">
        <div id="adminLoginSection" class="admin-login">
            <h3> Acceso de Administrador</h3>
            <input type="password" id="adminPassword" placeholder="Contrase帽a" onkeypress="if(event.key === 'Enter') adminLogin()">
            <button onclick="adminLogin()">Iniciar Sesi贸n</button>
        </div>
        
        <div id="adminPanelContent" style="display: none;">
            <div class="admin-header">
                <h2>锔 Panel de Administraci贸n</h2>
                <button class="admin-close" onclick="closeAdminPanel()"></button>
            </div>
            
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="switchTab('general')"> General</button>
                <button class="admin-tab" onclick="switchTab('matches')"> Partidos</button>
                <button class="admin-tab" onclick="switchTab('results')"> Resultados</button>
                <button class="admin-tab" onclick="switchTab('export')"> Datos</button>
                <button class="admin-tab" onclick="switchTab('security')"> Seguridad</button>
            </div>
            
            <div class="admin-content">
                <!-- General Tab -->
                <div id="tab-general" class="tab-panel active">
                    <div class="admin-section">
                        <h4>锔 Informaci贸n de la Liga</h4>
                        <div class="admin-grid">
                            <div class="admin-input-group">
                                <label for="adminLeagueName">Nombre de la Liga</label>
                                <input type="text" id="adminLeagueName" placeholder="Liga MX">
                            </div>
                            <div class="admin-input-group">
                                <label for="adminSeason">Temporada</label>
                                <input type="text" id="adminSeason" placeholder="Clausura 2025">
                            </div>
                            <div class="admin-input-group">
                                <label for="adminJornada">Jornada</label>
                                <input type="number" id="adminJornada" placeholder="1" min="1">
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h4> Configuraci贸n de Tiempo</h4>
                        <div class="admin-grid">
                            <div class="admin-input-group">
                                <label for="adminDeadlineDate">Fecha L铆mite</label>
                                <input type="date" id="adminDeadlineDate">
                            </div>
                            <div class="admin-input-group">
                                <label for="adminDeadlineTime">Hora L铆mite</label>
                                <input type="time" id="adminDeadlineTime">
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h4> Premios</h4>
                        <div class="admin-grid">
                            <div class="admin-input-group">
                                <label for="adminPrize1">1er Lugar (MXN)</label>
                                <input type="number" id="adminPrize1" placeholder="1000" min="0">
                            </div>
                            <div class="admin-input-group">
                                <label for="adminPrize2">2do Lugar (MXN)</label>
                                <input type="number" id="adminPrize2" placeholder="500" min="0">
                            </div>
                            <div class="admin-input-group">
                                <label for="adminPrize3">3er Lugar (MXN)</label>
                                <input type="number" id="adminPrize3" placeholder="500" min="0">
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h4> Estad铆sticas</h4>
                        <div class="admin-input-group">
                            <label for="adminParticipants">N煤mero de Participantes</label>
                            <input type="number" id="adminParticipants" placeholder="247" min="0">
                        </div>
                    </div>
                    
                    <div class="admin-actions">
                        <button class="btn-success" style="flex: 1;" onclick="saveGeneralConfig()"> Guardar Configuraci贸n</button>
                    </div>
                </div>
                
                <!-- Matches Tab -->
                <div id="tab-matches" class="tab-panel">
                    <div class="admin-section">
                        <h4> Configuraci贸n de Partidos</h4>
                        <div id="matchesConfigContainer"></div>
                        <button class="btn-primary" style="width: 100%; margin-top: 15px;" onclick="addMatchConfig()"> Agregar Partido</button>
                    </div>
                    
                    <div class="admin-actions">
                        <button class="btn-success" style="flex: 1;" onclick="saveMatchesConfig()"> Guardar Partidos</button>
                    </div>
                </div>
                
                <!-- Results Tab -->
                <div id="tab-results" class="tab-panel">
                    <div class="admin-section">
                        <h4> Captura de Resultados</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">Ingresa los resultados finales de cada partido</p>
                        <div id="resultsConfigContainer"></div>
                    </div>
                    
                    <div class="admin-actions">
                        <button class="btn-success" style="flex: 1;" onclick="saveResults()"> Guardar Resultados</button>
                    </div>
                </div>
                
                <!-- Export/Import Tab -->
                <div id="tab-export" class="tab-panel">
                    <div class="admin-section">
                        <h4> Exportar Configuraci贸n</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">Descarga la configuraci贸n actual en formato JSON</p>
                        <button class="btn-primary" style="width: 100%;" onclick="exportConfig()"> Exportar Configuraci贸n</button>
                    </div>
                    
                    <div class="admin-section">
                        <h4> Importar Configuraci贸n</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">Carga una configuraci贸n desde un archivo JSON</p>
                        <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importConfig(this)">
                        <button class="btn-primary" style="width: 100%;" onclick="document.getElementById('importFile').click()"> Importar Configuraci贸n</button>
                    </div>
                    
                    <div class="admin-section">
                        <h4>锔 Resetear Configuraci贸n</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">Restaura la configuraci贸n a los valores por defecto</p>
                        <button class="btn-danger" style="width: 100%;" onclick="resetConfig()"> Resetear a Valores por Defecto</button>
                    </div>
                </div>
                
                <!-- Security Tab -->
                <div id="tab-security" class="tab-panel">
                    <div class="admin-section">
                        <h4> Cambiar Contrase帽a</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">
                            La contrase帽a debe tener al menos 8 caracteres, incluir may煤sculas, min煤sculas y n煤meros.
                        </p>
                        <div class="admin-input-group">
                            <label for="currentPassword">Contrase帽a Actual</label>
                            <input type="password" id="currentPassword" placeholder="Ingresa tu contrase帽a actual">
                        </div>
                        <div class="admin-input-group">
                            <label for="newPassword">Nueva Contrase帽a</label>
                            <input type="password" id="newPassword" placeholder="M铆nimo 8 caracteres" oninput="updatePasswordStrength()">
                            <div id="passwordStrength" class="password-strength"></div>
                            <div id="passwordRequirements" class="password-requirements"></div>
                        </div>
                        <div class="admin-input-group">
                            <label for="confirmPassword">Confirmar Nueva Contrase帽a</label>
                            <input type="password" id="confirmPassword" placeholder="Repite la nueva contrase帽a">
                        </div>
                        <div class="admin-actions">
                            <button class="btn-success" style="flex: 1;" onclick="changePassword()"> Cambiar Contrase帽a</button>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h4> Informaci贸n de Seguridad</h4>
                        <p style="color: var(--text-secondary);">
                             La contrase帽a se almacena de forma segura usando hash SHA-256<br>
                             Nunca compartas tu contrase帽a con terceros<br>
                             Cambia tu contrase帽a peri贸dicamente<br>
                             Contrase帽a por defecto: <code style="background: var(--bg-secondary); padding: 2px 6px; border-radius: 4px;">admin123</code>
                        </p>
                        <p id="lastPasswordChange" style="color: var(--warning); margin-top: 15px; font-weight: 500;"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de confirmaci贸n con resumen -->
<div class="modal-overlay" id="confirmModal">
    <div class="modal" style="max-width: 500px;">
        <div class="modal-icon"></div>
        <h3>Confirma tu Quiniela</h3>
        <p style="margin-bottom: 10px;">Revisa tus predicciones antes de enviar:</p>
        <div class="predictions-summary" id="predictionsSummary"></div>
        <div style="background: var(--bg-secondary); padding: 10px; border-radius: 8px; margin-bottom: 15px;">
            <strong id="summaryName"></strong><br>
            <span style="color: var(--text-secondary); font-size: 0.85rem;" id="summaryEmail"></span>
        </div>
        <div class="modal-buttons">
            <button class="modal-btn cancel" onclick="closeModal()">锔 Modificar</button>
            <button class="modal-btn confirm" onclick="confirmSubmit()"> Confirmar Env铆o</button>
        </div>
    </div>
</div>

<!-- Modal de 茅xito -->
<div class="modal-overlay" id="successModal">
    <div class="modal success-modal" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
        <div class="modal-icon"></div>
        <h3 style="color: white;">隆Quiniela Enviada!</h3>
        <p style="color: rgba(255,255,255,0.9);">Tu participaci贸n ha sido registrada exitosamente. 隆Buena suerte!</p>
        <div id="participationCode" style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin: 15px 0; font-family: monospace; font-size: 1.1rem; color: white;"></div>
        <p style="color: rgba(255,255,255,0.7); font-size: 0.85rem;">Guarda este c贸digo como comprobante</p>
        <button class="modal-btn" style="width: 100%; background: white; color: var(--success);" onclick="closeSuccessModal()">Entendido</button>
    </div>
</div>

<!-- Header -->
<header class="header">
    <div class="header-content">
        <div class="logo"></div>
        <h1>Quiniela Liga MX</h1>
        <p class="jornada">Clausura 2025  Jornada 1</p>
    </div>
</header>

<!-- Contador de tiempo -->
<div class="countdown-container">
    <p class="countdown-title"> Tiempo restante para participar</p>
    <div class="countdown" id="countdown">
        <div class="countdown-item">
            <span class="countdown-number" id="days">00</span>
            <span class="countdown-label">D铆as</span>
        </div>
        <div class="countdown-item">
            <span class="countdown-number" id="hours">00</span>
            <span class="countdown-label">Horas</span>
        </div>
        <div class="countdown-item">
            <span class="countdown-number" id="minutes">00</span>
            <span class="countdown-label">Min</span>
        </div>
        <div class="countdown-item">
            <span class="countdown-number" id="seconds">00</span>
            <span class="countdown-label">Seg</span>
        </div>
    </div>
</div>

<!-- Barra de progreso -->
<div class="progress-container">
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="progress-text">
        <span>Progreso de tu quiniela</span>
        <span id="progressText">0 de 9 partidos</span>
    </div>
</div>

<main class="container">
    <!-- Banner de premio -->
    <div class="prize-banner">
        <h3>Premio al Primer Lugar</h3>
        <div class="prize-amount">$1,000 MXN</div>
    </div>

    <!-- Estad铆sticas -->
    <div class="stats-bar">
        <div class="stat-item">
            <div class="stat-number" id="participantes">247</div>
            <div class="stat-label">Participantes</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">9</div>
            <div class="stat-label">Partidos</div>
        </div>
        <div class="stat-item">
            <div class="stat-number">$3,000</div>
            <div class="stat-label">En premios</div>
        </div>
    </div>

    <!-- Leyenda -->
    <div class="legend">
        <div class="legend-item">
            <div class="legend-dot local"></div>
            <span>Local gana</span>
        </div>
        <div class="legend-item">
            <div class="legend-dot empate"></div>
            <span>Empate</span>
        </div>
        <div class="legend-item">
            <div class="legend-dot visita"></div>
            <span>Visita gana</span>
        </div>
    </div>

    <form id="quinielaForm">
        <!-- Partido 1 -->
        <div class="match-card" data-match="1">
            <div class="match-header">
                <div class="match-number">1</div>
                <div class="match-date"> Vie 10 Ene  19:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Am茅rica</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Chivas</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p1" id="p1L" value="L" required>
                <label for="p1L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p1" id="p1E" value="E">
                <label for="p1E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p1" id="p1V" value="V">
                <label for="p1V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 2 -->
        <div class="match-card" data-match="2">
            <div class="match-header">
                <div class="match-number">2</div>
                <div class="match-date"> Vie 10 Ene  21:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Cruz Azul</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Rayados</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p2" id="p2L" value="L" required>
                <label for="p2L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p2" id="p2E" value="E">
                <label for="p2E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p2" id="p2V" value="V">
                <label for="p2V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 3 -->
        <div class="match-card" data-match="3">
            <div class="match-header">
                <div class="match-number">3</div>
                <div class="match-date"> S谩b 11 Ene  17:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Le贸n</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Pumas</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p3" id="p3L" value="L" required>
                <label for="p3L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p3" id="p3E" value="E">
                <label for="p3E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p3" id="p3V" value="V">
                <label for="p3V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 4 -->
        <div class="match-card" data-match="4">
            <div class="match-header">
                <div class="match-number">4</div>
                <div class="match-date"> S谩b 11 Ene  19:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Tigres</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Toluca</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p4" id="p4L" value="L" required>
                <label for="p4L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p4" id="p4E" value="E">
                <label for="p4E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p4" id="p4V" value="V">
                <label for="p4V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 5 -->
        <div class="match-card" data-match="5">
            <div class="match-header">
                <div class="match-number">5</div>
                <div class="match-date"> S谩b 11 Ene  21:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Pachuca</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Santos</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p5" id="p5L" value="L" required>
                <label for="p5L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p5" id="p5E" value="E">
                <label for="p5E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p5" id="p5V" value="V">
                <label for="p5V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 6 -->
        <div class="match-card" data-match="6">
            <div class="match-header">
                <div class="match-number">6</div>
                <div class="match-date"> Dom 12 Ene  12:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Quer茅taro</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Mazatl谩n</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p6" id="p6L" value="L" required>
                <label for="p6L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p6" id="p6E" value="E">
                <label for="p6E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p6" id="p6V" value="V">
                <label for="p6V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 7 -->
        <div class="match-card" data-match="7">
            <div class="match-header">
                <div class="match-number">7</div>
                <div class="match-date"> Dom 12 Ene  17:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Atlas</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Necaxa</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p7" id="p7L" value="L" required>
                <label for="p7L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p7" id="p7E" value="E">
                <label for="p7E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p7" id="p7V" value="V">
                <label for="p7V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 8 -->
        <div class="match-card" data-match="8">
            <div class="match-header">
                <div class="match-number">8</div>
                <div class="match-date"> Dom 12 Ene  19:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo"></div>
                    <span class="team-name">Ju谩rez</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">San Luis</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p8" id="p8L" value="L" required>
                <label for="p8L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p8" id="p8E" value="E">
                <label for="p8E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p8" id="p8V" value="V">
                <label for="p8V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Partido 9 -->
        <div class="match-card" data-match="9">
            <div class="match-header">
                <div class="match-number">9</div>
                <div class="match-date"> Dom 12 Ene  21:00</div>
            </div>
            <div class="teams">
                <div class="team home">
                    <div class="team-logo">锔</div>
                    <span class="team-name">Puebla</span>
                </div>
                <div class="vs-badge">VS</div>
                <div class="team away">
                    <div class="team-logo"></div>
                    <span class="team-name">Tijuana</span>
                </div>
            </div>
            <div class="options">
                <input type="radio" name="p9" id="p9L" value="L" required>
                <label for="p9L">L<span class="label-text">Local</span></label>
                <input type="radio" name="p9" id="p9E" value="E">
                <label for="p9E">E<span class="label-text">Empate</span></label>
                <input type="radio" name="p9" id="p9V" value="V">
                <label for="p9V">V<span class="label-text">Visita</span></label>
            </div>
        </div>

        <!-- Datos del usuario -->
        <div class="user-section">
            <h3> Tus Datos</h3>
            <div class="input-group">
                <label for="nombre">Nombre completo</label>
                <input type="text" id="nombre" name="nombre" placeholder="Ej: Juan P茅rez Garc铆a" required autocomplete="name" maxlength="50" oninput="updateCharCounter(this, 50)">
                <div class="char-counter" id="nombreCounter">0/50</div>
                <div class="validation-message" id="nombreValidation"></div>
            </div>
            <div class="input-group">
                <label for="email">Correo electr贸nico</label>
                <input type="email" id="email" name="email" placeholder="Ej: tucorreo@email.com" required autocomplete="email" oninput="validateEmail(this)">
                <div class="validation-message" id="emailValidation"></div>
            </div>
            <div class="input-group">
                <label for="telefono">WhatsApp / Tel茅fono</label>
                <input type="tel" id="telefono" name="telefono" placeholder="Ej: 55 1234 5678" required autocomplete="tel" maxlength="15" oninput="updateCharCounter(this, 15); formatPhone(this)">
                <div class="char-counter" id="telefonoCounter">0/15</div>
                <div class="validation-message" id="telefonoValidation"></div>
            </div>
            <div class="terms-group">
                <input type="checkbox" id="terms" required>
                <label for="terms">Acepto los <a href="#" onclick="showTerms()">t茅rminos y condiciones</a> de la quiniela y confirmo que soy mayor de edad.</label>
            </div>
        </div>

        <button type="submit" class="submit-btn" id="submitBtn">
            <span> Enviar mi Quiniela</span>
        </button>
    </form>
</main>

<!-- Secci贸n de Preguntas Frecuentes -->
<div class="container">
    <div class="faq-section">
        <h3> Preguntas Frecuentes</h3>
        
        <div class="faq-item" onclick="toggleFaq(this)">
            <div class="faq-question">驴C贸mo participo en la quiniela?</div>
            <div class="faq-answer">
                Selecciona tu predicci贸n (Local, Empate o Visitante) para cada partido, completa tus datos personales y haz clic en "Enviar mi Quiniela". Recibir谩s una confirmaci贸n cuando tu participaci贸n sea registrada.
            </div>
        </div>
        
        <div class="faq-item" onclick="toggleFaq(this)">
            <div class="faq-question">驴C贸mo se determinan los ganadores?</div>
            <div class="faq-answer">
                El ganador es quien acierte m谩s predicciones correctas. En caso de empate en aciertos, el premio se divide entre los ganadores. Los resultados se publican al finalizar todos los partidos de la jornada.
            </div>
        </div>
        
        <div class="faq-item" onclick="toggleFaq(this)">
            <div class="faq-question">驴Puedo modificar mi quiniela despu茅s de enviarla?</div>
            <div class="faq-answer">
                Puedes enviar una nueva quiniela antes de que cierre el plazo. Solo se considerar谩 tu 煤ltima participaci贸n registrada con el mismo correo electr贸nico.
            </div>
        </div>
        
        <div class="faq-item" onclick="toggleFaq(this)">
            <div class="faq-question">驴Cu谩ndo recibir茅 mi premio si gano?</div>
            <div class="faq-answer">
                Los premios se entregan dentro de los 5 d铆as h谩biles posteriores al cierre de la jornada. Nos comunicaremos contigo al correo electr贸nico o WhatsApp que proporcionaste.
            </div>
        </div>
        
        <div class="faq-item" onclick="toggleFaq(this)">
            <div class="faq-question">驴Hay costo por participar?</div>
            <div class="faq-answer">
                La participaci贸n es completamente gratuita. Solo debes ser mayor de 18 a帽os y completar todos los campos requeridos.
            </div>
        </div>
    </div>
    
    <!-- Secci贸n de Soporte -->
    <div class="support-section">
        <h4> 驴Necesitas ayuda?</h4>
        <p style="color: var(--text-secondary); margin-top: 10px;">
            Si tienes dudas o problemas, cont谩ctanos:<br>
            <a href="mailto:soporte@quiniela.mx">soporte@quiniela.mx</a> | 
            <a href="https://wa.me/5215512345678" target="_blank">WhatsApp</a>
        </p>
    </div>
</div>

<footer class="footer">
    <p>漏 2025 Quiniela Liga MX  Todos los derechos reservados</p>
    <p style="margin-top: 10px; font-size: 0.75rem;">
        Desarrollado con わ para aficionados del f煤tbol mexicano
    </p>
</footer>

<script>
    // ==================== CONFIGURACIN ====================
    const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzaCNYQ46HVgp3jb97jAp5tvdlF7VHfQ4j9Fg3fNy12AKLyYl5O0SWfRRPH2IObNgmemQ/exec";
    window.TOTAL_MATCHES = 9;
    window.DEADLINE = new Date('2026-01-10T18:00:00'); // Fecha l铆mite para participar

    // ==================== ELEMENTOS DOM ====================
    const form = document.getElementById('quinielaForm');
    const submitBtn = document.getElementById('submitBtn');
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    const toastContainer = document.getElementById('toastContainer');
    const confirmModal = document.getElementById('confirmModal');

    // ==================== CONTADOR DE TIEMPO ====================
    function updateCountdown() {
        const now = new Date();
        const diff = window.DEADLINE - now;

        if (diff <= 0) {
            document.getElementById('days').textContent = '00';
            document.getElementById('hours').textContent = '00';
            document.getElementById('minutes').textContent = '00';
            document.getElementById('seconds').textContent = '00';
            submitBtn.disabled = true;
            submitBtn.innerHTML = ' Tiempo agotado';
            return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        document.getElementById('days').textContent = String(days).padStart(2, '0');
        document.getElementById('hours').textContent = String(hours).padStart(2, '0');
        document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
        document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');
    }

    setInterval(updateCountdown, 1000);
    updateCountdown();

    // ==================== BARRA DE PROGRESO ====================
    function updateProgress() {
        let selected = 0;
        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            if (form.querySelector(`input[name="p${i}"]:checked`)) {
                selected++;
            }
        }
        const percentage = (selected / window.TOTAL_MATCHES) * 100;
        progressFill.style.width = `${percentage}%`;
        progressText.textContent = `${selected} de ${window.TOTAL_MATCHES} partidos`;
        
        // Guardar en localStorage
        saveToLocalStorage();
    }

    // ==================== COLOREAR TARJETAS SELECCIONADAS ====================
    document.querySelectorAll('.options input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const card = this.closest('.match-card');
            card.classList.remove('selected-L', 'selected-E', 'selected-V');
            card.classList.add(`selected-${this.value}`);
            updateProgress();
        });
    });

    // ==================== LOCAL STORAGE ====================
    function saveToLocalStorage() {
        const data = {
            nombre: form.nombre.value,
            email: form.email.value,
            telefono: form.telefono.value,
            predictions: {}
        };
        
        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            const checked = form.querySelector(`input[name="p${i}"]:checked`);
            if (checked) {
                data.predictions[`p${i}`] = checked.value;
            }
        }
        
        localStorage.setItem('quinielaData', JSON.stringify(data));
    }

    function loadFromLocalStorage() {
        const saved = localStorage.getItem('quinielaData');
        if (!saved) return;

        try {
            const data = JSON.parse(saved);
            
            if (data.nombre) form.nombre.value = data.nombre;
            if (data.email) form.email.value = data.email;
            if (data.telefono) form.telefono.value = data.telefono;
            
            if (data.predictions) {
                Object.entries(data.predictions).forEach(([name, value]) => {
                    const radio = form.querySelector(`input[name="${name}"][value="${value}"]`);
                    if (radio) {
                        radio.checked = true;
                        const card = radio.closest('.match-card');
                        card.classList.add(`selected-${value}`);
                    }
                });
            }
            
            updateProgress();
            showToast('Se restauraron tus pron贸sticos guardados', 'success');
        } catch (e) {
            console.error('Error loading saved data:', e);
        }
    }

    // Cargar datos guardados al iniciar
    loadFromLocalStorage();

    // ==================== NOTIFICACIONES TOAST ====================
    function showToast(message, type = 'success') {
        const toast = document.createElement('div');
        toast.className = `toast ${type}`;
        
        const icon = type === 'success' ? '' : type === 'error' ? '' : '锔';
        toast.innerHTML = `<span>${icon}</span><span>${message}</span>`;
        
        toastContainer.appendChild(toast);
        
        setTimeout(() => {
            toast.style.animation = 'slideOut 0.3s ease forwards';
            setTimeout(() => toast.remove(), 300);
        }, 4000);
    }

    // ==================== MODAL DE CONFIRMACIN ====================
    function openModal() {
        confirmModal.classList.add('active');
    }

    function closeModal() {
        confirmModal.classList.remove('active');
    }

    // ==================== VALIDACIN Y ENVO ====================
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Rate limiting
        if (!checkRateLimit()) {
            return;
        }
        
        // Validaci贸n completa
        const validation = validateAllFields();
        
        if (!validation.isValid) {
            // Mostrar errores
            validation.errors.forEach((error, index) => {
                setTimeout(() => showToast(error, 'warning'), index * 500);
            });
            
            // Resaltar campos faltantes
            const firstMissing = highlightMissingMatches();
            if (firstMissing) {
                firstMissing.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            return;
        }
        
        // Generar resumen y mostrar modal
        generatePredictionsSummary();
        openModal();
    });

    function confirmSubmit() {
        closeModal();
        sendQuiniela();
    }

    function sendQuiniela() {
        // Deshabilitar bot贸n
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<div class="spinner"></div> Enviando...';

        // Recolectar datos
        const data = {
            nombre: form.nombre.value.trim(),
            email: form.email.value.trim(),
            telefono: form.telefono.value.trim(),
            timestamp: new Date().toISOString()
        };

        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            data[`p${i}`] = form.querySelector(`input[name="p${i}"]:checked`).value;
        }

        // Enviar a Google Sheets
        fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        })
        .then(() => {
            // Mostrar modal de 茅xito
            showSuccessModal();
            lastSubmitTime = Date.now();
            
            // Limpiar localStorage
            localStorage.removeItem('quinielaData');
            
            // Resetear formulario
            form.reset();
            document.querySelectorAll('.match-card').forEach(card => {
                card.classList.remove('selected-L', 'selected-E', 'selected-V', 'completed', 'missing');
            });
            updateProgress();
            updateProgressDots();
            
            // Resetear contadores
            document.getElementById('nombreCounter').textContent = '0/50';
            document.getElementById('telefonoCounter').textContent = '0/15';
            document.querySelectorAll('.validation-message').forEach(el => el.textContent = '');
            document.querySelectorAll('.input-group input').forEach(el => el.classList.remove('valid', 'invalid'));
            
            submitBtn.innerHTML = ' 隆Enviado con 茅xito!';
            
            setTimeout(() => {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<span> Enviar otra Quiniela</span>';
            }, 3000);
        })
        .catch(error => {
            console.error('Error:', error);
            showToast('Error al enviar. Por favor intenta de nuevo.', 'error');
            submitBtn.disabled = false;
            submitBtn.innerHTML = '<span> Reintentar</span>';
        });
    }

    // ==================== TRMINOS Y CONDICIONES ====================
    function showTerms() {
        alert(`TRMINOS Y CONDICIONES DE LA QUINIELA

1. PARTICIPACIN
- La participaci贸n es gratuita y abierta a mayores de 18 a帽os.
- Solo se permite una quiniela por persona.

2. PREMIOS
- 1er lugar: $1,000 MXN
- 2do lugar: $500 MXN
- 3er lugar: $500 MXN

3. CRITERIOS DE DESEMPATE
- Mayor n煤mero de aciertos.
- En caso de empate, se dividir谩 el premio.

4. ENTREGA DE PREMIOS
- Los premios se entregar谩n dentro de los 5 d铆as h谩biles posteriores al cierre de la jornada.

5. RESPONSABILIDAD
- El organizador se reserva el derecho de descalificar participantes que incurran en pr谩cticas fraudulentas.

Al participar, aceptas estos t茅rminos y condiciones.`);
    }

    // ==================== CONTADOR DE PARTICIPANTES (Simulado) ====================
    function updateParticipants() {
        const baseCount = 247;
        const randomAdd = Math.floor(Math.random() * 3);
        const current = parseInt(document.getElementById('participantes').textContent) || baseCount;
        document.getElementById('participantes').textContent = current + randomAdd;
    }

    // Simular nuevos participantes cada 30 segundos
    setInterval(updateParticipants, 30000);

    // ==================== SERVICE WORKER (PWA Ready) ====================
    if ('serviceWorker' in navigator) {
        // Aqu铆 podr铆as registrar un service worker para PWA
        // navigator.serviceWorker.register('/sw.js');
    }

    // ==================== ADMIN PANEL ====================
    // ==================== SISTEMA DE CONTRASEA SEGURA ====================
    const DEFAULT_PASSWORD_HASH = '240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9'; // Hash de 'admin123'
    
    // Funci贸n para generar hash SHA-256
    async function hashPassword(password) {
        const encoder = new TextEncoder();
        const data = encoder.encode(password);
        const hashBuffer = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
    
    // Obtener el hash de contrase帽a almacenado
    function getStoredPasswordHash() {
        return localStorage.getItem('adminPasswordHash') || DEFAULT_PASSWORD_HASH;
    }
    
    // Guardar nuevo hash de contrase帽a
    function setStoredPasswordHash(hash) {
        localStorage.setItem('adminPasswordHash', hash);
        localStorage.setItem('lastPasswordChange', new Date().toISOString());
    }
    
    // Validar fortaleza de contrase帽a
    function validatePasswordStrength(password) {
        const minLength = password.length >= 8;
        const hasUppercase = /[A-Z]/.test(password);
        const hasLowercase = /[a-z]/.test(password);
        const hasNumber = /[0-9]/.test(password);
        const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);
        
        let strength = 0;
        if (minLength) strength++;
        if (hasUppercase && hasLowercase) strength++;
        if (hasNumber) strength++;
        if (hasSpecial) strength++;
        
        let messages = [];
        if (!minLength) messages.push('8+ caracteres');
        if (!hasUppercase) messages.push('may煤scula');
        if (!hasLowercase) messages.push('min煤scula');
        if (!hasNumber) messages.push('n煤mero');
        
        return {
            isValid: minLength && hasUppercase && hasLowercase && hasNumber,
            strength: strength,
            messages: messages
        };
    }
    
    // Actualizar indicador de fortaleza visual
    function updatePasswordStrength() {
        const password = document.getElementById('newPassword').value;
        const indicator = document.getElementById('passwordStrength');
        const requirements = document.getElementById('passwordRequirements');
        const validation = validatePasswordStrength(password);
        
        indicator.className = 'password-strength';
        
        if (password.length === 0) {
            requirements.textContent = '';
            requirements.className = 'password-requirements';
        } else if (validation.strength <= 1) {
            indicator.classList.add('weak');
            requirements.textContent = 'Falta: ' + validation.messages.join(', ');
            requirements.className = 'password-requirements invalid';
        } else if (validation.strength <= 2) {
            indicator.classList.add('medium');
            requirements.textContent = 'Falta: ' + validation.messages.join(', ');
            requirements.className = 'password-requirements invalid';
        } else {
            indicator.classList.add('strong');
            requirements.textContent = ' Contrase帽a segura';
            requirements.className = 'password-requirements valid';
        }
    }
    
    // Cambiar contrase帽a
    async function changePassword() {
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        if (!currentPassword || !newPassword || !confirmPassword) {
            showToast('Completa todos los campos', 'warning');
            return;
        }
        
        // Verificar contrase帽a actual
        const currentHash = await hashPassword(currentPassword);
        if (currentHash !== getStoredPasswordHash()) {
            showToast('La contrase帽a actual es incorrecta', 'error');
            return;
        }
        
        // Validar nueva contrase帽a
        const validation = validatePasswordStrength(newPassword);
        if (!validation.isValid) {
            showToast('La contrase帽a no cumple los requisitos m铆nimos', 'warning');
            return;
        }
        
        // Verificar que coincidan
        if (newPassword !== confirmPassword) {
            showToast('Las contrase帽as no coinciden', 'error');
            return;
        }
        
        // Verificar que sea diferente a la anterior
        const newHash = await hashPassword(newPassword);
        if (newHash === getStoredPasswordHash()) {
            showToast('La nueva contrase帽a debe ser diferente a la actual', 'warning');
            return;
        }
        
        // Guardar nueva contrase帽a
        setStoredPasswordHash(newHash);
        
        // Limpiar campos
        document.getElementById('currentPassword').value = '';
        document.getElementById('newPassword').value = '';
        document.getElementById('confirmPassword').value = '';
        document.getElementById('passwordStrength').className = 'password-strength';
        document.getElementById('passwordRequirements').textContent = '';
        
        updateLastPasswordChangeDisplay();
        showToast('隆Contrase帽a cambiada exitosamente!', 'success');
    }
    
    // Mostrar 煤ltima actualizaci贸n de contrase帽a
    function updateLastPasswordChangeDisplay() {
        const lastChange = localStorage.getItem('lastPasswordChange');
        const element = document.getElementById('lastPasswordChange');
        if (element) {
            if (lastChange) {
                const date = new Date(lastChange);
                element.textContent = ' ltimo cambio: ' + date.toLocaleDateString('es-MX', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                element.style.color = 'var(--success)';
            } else {
                element.textContent = '锔 Usando contrase帽a por defecto - 隆Se recomienda cambiarla!';
                element.style.color = 'var(--warning)';
            }
        }
    }
    let isAdminLoggedIn = false;
    
    // Default configuration
    const DEFAULT_CONFIG = {
        leagueName: 'Quiniela Liga MX',
        season: 'Clausura 2025',
        jornada: 1,
        deadlineDate: '2026-01-10',
        deadlineTime: '18:00',
        prize1: 1000,
        prize2: 500,
        prize3: 500,
        participants: 247,
        matches: [
            { number: 1, home: 'Am茅rica', homeLogo: '', away: 'Chivas', awayLogo: '', date: 'Vie 10 Ene', time: '19:00' },
            { number: 2, home: 'Cruz Azul', homeLogo: '', away: 'Rayados', awayLogo: '', date: 'Vie 10 Ene', time: '21:00' },
            { number: 3, home: 'Le贸n', homeLogo: '', away: 'Pumas', awayLogo: '', date: 'S谩b 11 Ene', time: '17:00' },
            { number: 4, home: 'Tigres', homeLogo: '', away: 'Toluca', awayLogo: '', date: 'S谩b 11 Ene', time: '19:00' },
            { number: 5, home: 'Pachuca', homeLogo: '', away: 'Santos', awayLogo: '', date: 'S谩b 11 Ene', time: '21:00' },
            { number: 6, home: 'Quer茅taro', homeLogo: '', away: 'Mazatl谩n', awayLogo: '', date: 'Dom 12 Ene', time: '12:00' },
            { number: 7, home: 'Atlas', homeLogo: '', away: 'Necaxa', awayLogo: '', date: 'Dom 12 Ene', time: '17:00' },
            { number: 8, home: 'Ju谩rez', homeLogo: '', away: 'San Luis', awayLogo: '', date: 'Dom 12 Ene', time: '19:00' },
            { number: 9, home: 'Puebla', homeLogo: '锔', away: 'Tijuana', awayLogo: '', date: 'Dom 12 Ene', time: '21:00' }
        ],
        results: []
    };
    
    function openAdminPanel() {
        document.getElementById('adminModal').classList.add('active');
    }
    
    function closeAdminPanel() {
        document.getElementById('adminModal').classList.remove('active');
        isAdminLoggedIn = false;
        document.getElementById('adminLoginSection').style.display = 'block';
        document.getElementById('adminPanelContent').style.display = 'none';
        document.getElementById('adminPassword').value = '';
    }
    
    async function adminLogin() {
        const password = document.getElementById('adminPassword').value;
        if (!password) {
            showToast('Ingresa una contrase帽a', 'warning');
            return;
        }
        
        const hashedInput = await hashPassword(password);
        const storedHash = getStoredPasswordHash();
        
        if (hashedInput === storedHash) {
            isAdminLoggedIn = true;
            document.getElementById('adminLoginSection').style.display = 'none';
            document.getElementById('adminPanelContent').style.display = 'block';
            loadAdminConfig();
            updateLastPasswordChangeDisplay();
            showToast(' Acceso concedido', 'success');
        } else {
            showToast('Contrase帽a incorrecta', 'error');
            document.getElementById('adminPassword').value = '';
        }
    }
    
    function switchTab(tabName) {
        // Update tab buttons
        document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
        event.target.classList.add('active');
        
        // Update tab panels
        document.querySelectorAll('.tab-panel').forEach(panel => panel.classList.remove('active'));
        document.getElementById(`tab-${tabName}`).classList.add('active');
        
        // Load specific tab data
        if (tabName === 'matches') {
            renderMatchesConfig();
        } else if (tabName === 'results') {
            renderResultsConfig();
        } else if (tabName === 'security') {
            updateLastPasswordChangeDisplay();
        }
    }
    
    function getAdminConfig() {
        const saved = localStorage.getItem('adminConfig');
        return saved ? JSON.parse(saved) : DEFAULT_CONFIG;
    }
    
    function saveAdminConfig(config) {
        localStorage.setItem('adminConfig', JSON.stringify(config));
    }
    
    function loadAdminConfig() {
        const config = getAdminConfig();
        
        // Load general settings
        document.getElementById('adminLeagueName').value = config.leagueName || '';
        document.getElementById('adminSeason').value = config.season || '';
        document.getElementById('adminJornada').value = config.jornada || 1;
        document.getElementById('adminDeadlineDate').value = config.deadlineDate || '';
        document.getElementById('adminDeadlineTime').value = config.deadlineTime || '';
        document.getElementById('adminPrize1').value = config.prize1 || 0;
        document.getElementById('adminPrize2').value = config.prize2 || 0;
        document.getElementById('adminPrize3').value = config.prize3 || 0;
        document.getElementById('adminParticipants').value = config.participants || 0;
    }
    
    function saveGeneralConfig() {
        const config = getAdminConfig();
        
        config.leagueName = document.getElementById('adminLeagueName').value;
        config.season = document.getElementById('adminSeason').value;
        config.jornada = parseInt(document.getElementById('adminJornada').value) || 1;
        config.deadlineDate = document.getElementById('adminDeadlineDate').value;
        config.deadlineTime = document.getElementById('adminDeadlineTime').value;
        config.prize1 = parseInt(document.getElementById('adminPrize1').value) || 0;
        config.prize2 = parseInt(document.getElementById('adminPrize2').value) || 0;
        config.prize3 = parseInt(document.getElementById('adminPrize3').value) || 0;
        config.participants = parseInt(document.getElementById('adminParticipants').value) || 0;
        
        saveAdminConfig(config);
        applyConfiguration();
        showToast('Configuraci贸n general guardada', 'success');
    }
    
    function renderMatchesConfig() {
        const config = getAdminConfig();
        const container = document.getElementById('matchesConfigContainer');
        
        if (!config.matches || config.matches.length === 0) {
            config.matches = DEFAULT_CONFIG.matches;
        }
        
        container.innerHTML = config.matches.map((match, index) => `
            <div class="match-config" data-index="${index}">
                <div class="match-config-header">
                    <h5>Partido ${match.number}</h5>
                    <button class="btn-small btn-danger" onclick="removeMatch(${index})">锔 Eliminar</button>
                </div>
                <div class="admin-grid">
                    <div class="admin-input-group">
                        <label>Equipo Local</label>
                        <input type="text" value="${match.home}" onchange="updateMatch(${index}, 'home', this.value)">
                    </div>
                    <div class="admin-input-group">
                        <label>Logo Local</label>
                        <input type="text" value="${match.homeLogo}" onchange="updateMatch(${index}, 'homeLogo', this.value)">
                    </div>
                    <div class="admin-input-group">
                        <label>Equipo Visitante</label>
                        <input type="text" value="${match.away}" onchange="updateMatch(${index}, 'away', this.value)">
                    </div>
                    <div class="admin-input-group">
                        <label>Logo Visitante</label>
                        <input type="text" value="${match.awayLogo}" onchange="updateMatch(${index}, 'awayLogo', this.value)">
                    </div>
                    <div class="admin-input-group">
                        <label>Fecha</label>
                        <input type="text" value="${match.date}" onchange="updateMatch(${index}, 'date', this.value)">
                    </div>
                    <div class="admin-input-group">
                        <label>Hora</label>
                        <input type="time" value="${match.time}" onchange="updateMatch(${index}, 'time', this.value)">
                    </div>
                </div>
            </div>
        `).join('');
    }
    
    function updateMatch(index, field, value) {
        const config = getAdminConfig();
        config.matches[index][field] = value;
        saveAdminConfig(config);
    }
    
    function addMatchConfig() {
        const config = getAdminConfig();
        const newNumber = config.matches.length + 1;
        config.matches.push({
            number: newNumber,
            home: 'Equipo Local',
            homeLogo: '',
            away: 'Equipo Visitante',
            awayLogo: '',
            date: 'Fecha',
            time: '20:00'
        });
        saveAdminConfig(config);
        renderMatchesConfig();
        showToast('Partido agregado', 'success');
    }
    
    function removeMatch(index) {
        if (!confirm('驴Est谩s seguro de eliminar este partido?')) return;
        
        const config = getAdminConfig();
        config.matches.splice(index, 1);
        // Renumber matches
        config.matches.forEach((match, idx) => {
            match.number = idx + 1;
        });
        saveAdminConfig(config);
        renderMatchesConfig();
        showToast('Partido eliminado', 'success');
    }
    
    function saveMatchesConfig() {
        applyConfiguration();
        showToast('Configuraci贸n de partidos guardada', 'success');
    }
    
    function renderResultsConfig() {
        const config = getAdminConfig();
        const container = document.getElementById('resultsConfigContainer');
        
        if (!config.results) {
            config.results = [];
        }
        
        container.innerHTML = config.matches.map((match, index) => {
            const result = config.results[index] || { home: '', away: '' };
            return `
                <div class="match-config">
                    <div class="match-config-header">
                        <h5>${match.home} vs ${match.away}</h5>
                    </div>
                    <div class="result-input">
                        <div class="admin-input-group" style="margin: 0;">
                            <label>${match.home}</label>
                            <input type="number" min="0" value="${result.home}" 
                                   onchange="updateResult(${index}, 'home', this.value)" 
                                   placeholder="0">
                        </div>
                        <span class="result-separator">-</span>
                        <div class="admin-input-group" style="margin: 0;">
                            <label>${match.away}</label>
                            <input type="number" min="0" value="${result.away}" 
                                   onchange="updateResult(${index}, 'away', this.value)" 
                                   placeholder="0">
                        </div>
                    </div>
                </div>
            `;
        }).join('');
    }
    
    function updateResult(index, field, value) {
        const config = getAdminConfig();
        if (!config.results[index]) {
            config.results[index] = { home: '', away: '' };
        }
        config.results[index][field] = value;
        saveAdminConfig(config);
    }
    
    function saveResults() {
        showToast('Resultados guardados correctamente', 'success');
    }
    
    function applyConfiguration() {
        const config = getAdminConfig();
        
        // Update header
        const headerTitle = document.querySelector('.header h1');
        if (headerTitle && config.leagueName) {
            headerTitle.textContent = config.leagueName;
        }
        
        const jornada = document.querySelector('.header .jornada');
        if (jornada && config.season && config.jornada) {
            jornada.textContent = `${config.season}  Jornada ${config.jornada}`;
        }
        
        // Update title
        if (config.leagueName && config.jornada) {
            document.title = ` ${config.leagueName} - Jornada ${config.jornada}`;
        }
        
        // Update deadline
        if (config.deadlineDate && config.deadlineTime) {
            const newDeadline = new Date(`${config.deadlineDate}T${config.deadlineTime}:00`);
            window.DEADLINE = newDeadline;
            updateCountdown();
        }
        
        // Update prizes
        const prizeAmount = document.querySelector('.prize-amount');
        if (prizeAmount && config.prize1) {
            prizeAmount.textContent = `$${config.prize1.toLocaleString()} MXN`;
        }
        
        const statsBar = document.querySelector('.stats-bar');
        if (statsBar) {
            const totalPrizes = config.prize1 + config.prize2 + config.prize3;
            statsBar.innerHTML = `
                <div class="stat-item">
                    <div class="stat-number" id="participantes">${config.participants}</div>
                    <div class="stat-label">Participantes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">${config.matches.length}</div>
                    <div class="stat-label">Partidos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">$${totalPrizes.toLocaleString()}</div>
                    <div class="stat-label">En premios</div>
                </div>
            `;
        }
        
        // Update matches
        updateMatchesDisplay();
    }
    
    function updateMatchesDisplay() {
        const config = getAdminConfig();
        const formElement = document.getElementById('quinielaForm');
        
        // Remove old match cards
        const oldCards = formElement.querySelectorAll('.match-card');
        oldCards.forEach(card => card.remove());
        
        // Get reference point (user section)
        const userSection = formElement.querySelector('.user-section');
        
        // Add new match cards
        config.matches.forEach(match => {
            const matchCard = document.createElement('div');
            matchCard.className = 'match-card';
            matchCard.setAttribute('data-match', match.number);
            matchCard.innerHTML = `
                <div class="match-header">
                    <div class="match-number">${match.number}</div>
                    <div class="match-date"> ${match.date}  ${match.time}</div>
                </div>
                <div class="teams">
                    <div class="team home">
                        <div class="team-logo">${match.homeLogo}</div>
                        <span class="team-name">${match.home}</span>
                    </div>
                    <div class="vs-badge">VS</div>
                    <div class="team away">
                        <div class="team-logo">${match.awayLogo}</div>
                        <span class="team-name">${match.away}</span>
                    </div>
                </div>
                <div class="options">
                    <input type="radio" name="p${match.number}" id="p${match.number}L" value="L" required>
                    <label for="p${match.number}L">L<span class="label-text">Local</span></label>
                    <input type="radio" name="p${match.number}" id="p${match.number}E" value="E">
                    <label for="p${match.number}E">E<span class="label-text">Empate</span></label>
                    <input type="radio" name="p${match.number}" id="p${match.number}V" value="V">
                    <label for="p${match.number}V">V<span class="label-text">Visita</span></label>
                </div>
            `;
            
            formElement.insertBefore(matchCard, userSection);
        });
        
        // Re-attach event listeners for new cards
        document.querySelectorAll('.options input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const card = this.closest('.match-card');
                card.classList.remove('selected-L', 'selected-E', 'selected-V');
                card.classList.add(`selected-${this.value}`);
                updateProgress();
            });
        });
        
        // Update total matches constant
        window.TOTAL_MATCHES = config.matches.length;
        updateProgress();
    }
    
    function exportConfig() {
        const config = getAdminConfig();
        const dataStr = JSON.stringify(config, null, 2);
        const dataBlob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(dataBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `quiniela-config-${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        URL.revokeObjectURL(url);
        showToast('Configuraci贸n exportada', 'success');
    }
    
    function importConfig(input) {
        const file = input.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const config = JSON.parse(e.target.result);
                saveAdminConfig(config);
                loadAdminConfig();
                applyConfiguration();
                showToast('Configuraci贸n importada correctamente', 'success');
                input.value = '';
            } catch (error) {
                showToast('Error al importar: archivo inv谩lido', 'error');
                input.value = '';
            }
        };
        reader.readAsText(file);
    }
    
    function resetConfig() {
        if (!confirm('驴Est谩s seguro de resetear toda la configuraci贸n? Esta acci贸n no se puede deshacer.')) {
            return;
        }
        
        saveAdminConfig(DEFAULT_CONFIG);
        loadAdminConfig();
        applyConfiguration();
        showToast('Configuraci贸n restablecida a valores por defecto', 'success');
    }
    
    // Apply configuration on page load
    window.addEventListener('DOMContentLoaded', function() {
                    localStorage.removeItem('adminPasswordHash'); // Reset password to admin123
        applyConfiguration();
    });

    // ==================== ANIMACIN DE ENTRADA ====================
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, { threshold: 0.1 });

    document.querySelectorAll('.match-card').forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = `all 0.5s ease ${index * 0.05}s`;
        observer.observe(card);
    });

    // ==================== MEJORAS UX ====================
    
    // Inicializar dots de progreso
    function initProgressDots() {
        const container = document.getElementById('progressDots');
        if (!container) return;
        
        container.innerHTML = '';
        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            const dot = document.createElement('div');
            dot.className = 'progress-dot';
            dot.setAttribute('data-match', i);
            dot.onclick = () => scrollToMatch(i);
            container.appendChild(dot);
        }
        updateProgressDots();
    }
    
    // Actualizar dots de progreso
    function updateProgressDots() {
        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            const dot = document.querySelector(`.progress-dot[data-match="${i}"]`);
            const card = document.querySelector(`[data-match="${i}"]`);
            const isSelected = form.querySelector(`input[name="p${i}"]:checked`);
            
            if (dot) {
                dot.classList.toggle('completed', !!isSelected);
            }
            if (card) {
                card.classList.remove('completed', 'missing');
                if (isSelected) {
                    card.classList.add('completed');
                }
            }
        }
    }
    
    // Scroll a un partido espec铆fico
    function scrollToMatch(matchNum) {
        const card = document.querySelector(`[data-match="${matchNum}"]`);
        if (card) {
            card.scrollIntoView({ behavior: 'smooth', block: 'center' });
            card.classList.add('shake');
            setTimeout(() => card.classList.remove('shake'), 500);
        }
    }
    
    // Marcar partidos faltantes
    function highlightMissingMatches() {
        let firstMissing = null;
        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            const card = document.querySelector(`[data-match="${i}"]`);
            const isSelected = form.querySelector(`input[name="p${i}"]:checked`);
            
            if (card) {
                card.classList.remove('missing');
                if (!isSelected) {
                    card.classList.add('missing');
                    if (!firstMissing) firstMissing = card;
                }
            }
        }
        return firstMissing;
    }
    
    // Contador de caracteres
    function updateCharCounter(input, maxLength) {
        const counter = document.getElementById(input.id + 'Counter');
        if (counter) {
            const length = input.value.length;
            counter.textContent = length + '/' + maxLength;
            counter.className = 'char-counter';
            if (length >= maxLength * 0.9) {
                counter.classList.add('warning');
            }
            if (length >= maxLength) {
                counter.classList.add('error');
            }
        }
        
        // Validar nombre
        if (input.id === 'nombre') {
            validateName(input);
        }
    }
    
    // Validar nombre
    function validateName(input) {
        const validation = document.getElementById('nombreValidation');
        const value = input.value.trim();
        
        if (value.length === 0) {
            validation.textContent = '';
            validation.className = 'validation-message';
            input.classList.remove('valid', 'invalid');
        } else if (value.length < 3) {
            validation.textContent = ' El nombre es muy corto';
            validation.className = 'validation-message error';
            input.classList.remove('valid');
            input.classList.add('invalid');
        } else if (!/^[a-zA-Z谩茅铆贸煤帽\s]+$/.test(value)) {
            validation.textContent = ' Solo letras y espacios';
            validation.className = 'validation-message error';
            input.classList.remove('valid');
            input.classList.add('invalid');
        } else {
            validation.textContent = ' Nombre v谩lido';
            validation.className = 'validation-message success';
            input.classList.remove('invalid');
            input.classList.add('valid');
        }
    }
    
    // Validar email
    function validateEmail(input) {
        const validation = document.getElementById('emailValidation');
        const value = input.value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        
        if (value.length === 0) {
            validation.textContent = '';
            validation.className = 'validation-message';
            input.classList.remove('valid', 'invalid');
        } else if (!emailRegex.test(value)) {
            validation.textContent = ' Correo electr贸nico inv谩lido';
            validation.className = 'validation-message error';
            input.classList.remove('valid');
            input.classList.add('invalid');
        } else {
            validation.textContent = ' Correo v谩lido';
            validation.className = 'validation-message success';
            input.classList.remove('invalid');
            input.classList.add('valid');
        }
        
        return emailRegex.test(value);
    }
    
    // Formatear tel茅fono
    function formatPhone(input) {
        let value = input.value.replace(/\D/g, '');
        if (value.length > 10) value = value.substring(0, 10);
        
        // Formato: XX XXXX XXXX
        if (value.length > 6) {
            value = value.substring(0, 2) + ' ' + value.substring(2, 6) + ' ' + value.substring(6);
        } else if (value.length > 2) {
            value = value.substring(0, 2) + ' ' + value.substring(2);
        }
        
        input.value = value;
        
        const validation = document.getElementById('telefonoValidation');
        const numericValue = input.value.replace(/\D/g, '');
        
        if (numericValue.length === 0) {
            validation.textContent = '';
            validation.className = 'validation-message';
            input.classList.remove('valid', 'invalid');
        } else if (numericValue.length < 10) {
            validation.textContent = ' El tel茅fono debe tener 10 d铆gitos';
            validation.className = 'validation-message error';
            input.classList.remove('valid');
            input.classList.add('invalid');
        } else {
            validation.textContent = ' Tel茅fono v谩lido';
            validation.className = 'validation-message success';
            input.classList.remove('invalid');
            input.classList.add('valid');
        }
    }
    
    // Toggle FAQ
    function toggleFaq(element) {
        // Cerrar otros FAQs
        document.querySelectorAll('.faq-item.open').forEach(item => {
            if (item !== element) item.classList.remove('open');
        });
        element.classList.toggle('open');
    }
    
    // Generar resumen de predicciones
    function generatePredictionsSummary() {
        const config = getAdminConfig();
        const summary = document.getElementById('predictionsSummary');
        let html = '';
        
        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            const selected = form.querySelector(`input[name="p${i}"]:checked`);
            if (selected) {
                const match = config.matches[i - 1] || { home: 'Equipo ' + i, away: 'Equipo ' + i };
                const resultText = selected.value === 'L' ? 'Local' : selected.value === 'E' ? 'Empate' : 'Visita';
                
                html += '<div class="prediction-item">';
                html += '<span class="teams">' + match.home + ' vs ' + match.away + '</span>';
                html += '<span class="result ' + selected.value + '">' + resultText + '</span>';
                html += '</div>';
            }
        }
        
        summary.innerHTML = html;
        
        // Actualizar nombre y email en el resumen
        document.getElementById('summaryName').textContent = form.nombre.value;
        document.getElementById('summaryEmail').textContent = form.email.value;
    }
    
    // Generar c贸digo de participaci贸n
    function generateParticipationCode() {
        const timestamp = Date.now().toString(36).toUpperCase();
        const random = Math.random().toString(36).substring(2, 6).toUpperCase();
        return 'QNL-' + timestamp.slice(-4) + '-' + random;
    }
    
    // Mostrar modal de 茅xito
    function showSuccessModal() {
        const code = generateParticipationCode();
        document.getElementById('participationCode').textContent = code;
        document.getElementById('successModal').classList.add('active');
        
        // Guardar en historial local
        saveToHistory(code);
    }
    
    // Cerrar modal de 茅xito
    function closeSuccessModal() {
        document.getElementById('successModal').classList.remove('active');
    }
    
    // Guardar en historial local
    function saveToHistory(code) {
        const history = JSON.parse(localStorage.getItem('quinielaHistory') || '[]');
        history.unshift({
            code: code,
            date: new Date().toISOString(),
            email: form.email.value,
            status: 'pending'
        });
        // Mantener solo las 煤ltimas 10 participaciones
        if (history.length > 10) history.pop();
        localStorage.setItem('quinielaHistory', JSON.stringify(history));
    }
    
    // Rate limiting
    let lastSubmitTime = 0;
    const RATE_LIMIT_MS = 60000; // 1 minuto entre env铆os
    
    function checkRateLimit() {
        const now = Date.now();
        if (now - lastSubmitTime < RATE_LIMIT_MS) {
            const remaining = Math.ceil((RATE_LIMIT_MS - (now - lastSubmitTime)) / 1000);
            document.getElementById('rateLimitWarning').classList.add('active');
            document.getElementById('rateLimitWarning').textContent = 
                ' Espera ' + remaining + ' segundos antes de enviar otra quiniela';
            return false;
        }
        document.getElementById('rateLimitWarning').classList.remove('active');
        return true;
    }
    
    // Sanitizar entrada (prevenir XSS)
    function sanitizeInput(str) {
        const div = document.createElement('div');
        div.textContent = str;
        return div.innerHTML;
    }
    
    // Validaci贸n completa antes de enviar
    function validateAllFields() {
        let isValid = true;
        let errors = [];
        
        // Validar predicciones
        let missingMatches = [];
        for (let i = 1; i <= window.TOTAL_MATCHES; i++) {
            if (!form.querySelector(`input[name="p${i}"]:checked`)) {
                missingMatches.push(i);
                isValid = false;
            }
        }
        
        if (missingMatches.length > 0) {
            errors.push('Faltan predicciones en los partidos: ' + missingMatches.join(', '));
        }
        
        // Validar nombre
        const nombre = form.nombre.value.trim();
        if (nombre.length < 3) {
            errors.push('El nombre debe tener al menos 3 caracteres');
            isValid = false;
        }
        
        // Validar email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(form.email.value.trim())) {
            errors.push('El correo electr贸nico no es v谩lido');
            isValid = false;
        }
        
        // Validar tel茅fono
        const telefono = form.telefono.value.replace(/\D/g, '');
        if (telefono.length < 10) {
            errors.push('El tel茅fono debe tener 10 d铆gitos');
            isValid = false;
        }
        
        // Validar t茅rminos
        if (!form.terms.checked) {
            errors.push('Debes aceptar los t茅rminos y condiciones');
            isValid = false;
        }
        
        return { isValid, errors };
    }

    // Inicializar al cargar
    document.addEventListener('DOMContentLoaded', function() {
        initProgressDots();
        
        // Actualizar dots cuando cambia una selecci贸n
        document.querySelectorAll('.options input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', updateProgressDots);
        });
    });
    
    // ==================== ADMIN: EXPORTAR CSV ====================
    function exportParticipantsCSV() {
        // Esta funci贸n simula exportar datos - en producci贸n se conectar铆a a Google Sheets
        const csvContent = "Nombre,Email,Tel茅fono,Fecha,P1,P2,P3,P4,P5,P6,P7,P8,P9\n";
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = 'participantes_jornada_' + new Date().toISOString().split('T')[0] + '.csv';
        link.click();
        URL.revokeObjectURL(url);
        showToast('Archivo CSV generado', 'success');
    }

</script>

</body>
</html>
